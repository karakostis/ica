<!DOCTYPE html>
<html lang="en">

  <head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">


    <title>Integrated Context Analysis</title>
    <!-- Favicons-->
    <link rel="shortcut icon" href="img/favicon.ico">
    <!-- Bootstrap core CSS -->
    <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom fonts for this template -->
    <link href="vendor/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css">
    <link href='https://fonts.googleapis.com/css?family=Kaushan+Script' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Roboto+Slab:400,100,300,700' rel='stylesheet' type='text/css'>

    <!-- Custom styles for this template -->
    <link href="css/hta.min.css" rel="stylesheet">

    <style>

    section {
      padding-top: 50px;
      padding-bottom: 50px;
    }

    </style>

  </head>

  <body id="page-top">

    <!-- Navigation <nav class="navbar navbar-inverse navbar-expand-lg navbar-dark navbar-fixed-top" id="mainNav" role="navigation" style="height:80px;-->
    <nav class="navbar navbar-inverse navbar-expand-lg navbar-dark fixed-top" id="mainNav" role="navigation" style="height:80px; background-color:#2a93fc">
      <div class="container">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
            <a class="navbar-brand" href="#" style="background-image:url('/img/wfp_logo_72_white.png'); background-position-x: 15px; height: 65px; background-repeat: no-repeat;  color:white; margin-top:5px; font-size:32px; padding-left: 85px; font-family: Helvetica Neue,Helvetica,Arial,sans-serif;"><strong>WFP </strong> ICA</a>
        </div>
        <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
          Menu
          <i class="fa fa-bars"></i>
        </button>
        <div class="collapse navbar-collapse" id="navbarResponsive">
          <ul class="navbar-nav text-uppercase ml-auto">
            <li class="nav-item">
              <a class="nav-link js-scroll-trigger" href="#services">Access Analysis</a>
            </li>
            <li class="nav-item">
              <a class="nav-link js-scroll-trigger" href="#about">Project</a>
            </li>
            <li class="nav-item">
              <a class="nav-link js-scroll-trigger" href="#contact">Contact</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <!-- Header -->
    <header class="masthead" style="margin-top:81px">
      <div class="container">
        <div class="intro-text">
          <!-- <div class="intro-lead-in"> test </div> -->
          <div class="intro-heading text-uppercase">Integrated Context Analysis</div>
          <a class="btn btn-primary btn-xl text-uppercase js-scroll-trigger" href="#services" target="_blank" style="border-color:#fed136;">ACCESS ICA ANALYSIS  </a>
        <!-- </div> -->
        </div>
      </div>
    </header>

    <!-- Project -->
    <section id="services">
      <div class="container">
        <!--
        <div class="row">
          <div class="col-lg-12 text-center">
            <h2 class="page-header section-heading">Integrated Context Analysis</h2>
            <hr>
            <h3 class="section-subheading text-muted">Natural Shocks Risk, Drought Risk, Livelihood Zones, Land Degradation</h3>
          </div>
        </div>
        -->

        <div class="row text-center">
          <div id="container" class="col-md-12" style="width: 700px; height: 500px;">
          </div>
        </div>
        </br></br>
        <!-- the area with the buttons -->
        <div class="row">
          <div class="col-lg-12 text-center" id="buttons">
            <button type="button" class="btn btn-primary ica_status ica_finalized">Finalized</button>
            <button type="button" class="btn btn-primary ica_status ica_ongoing">Ongoing</button>
            <button type="button" class="btn btn-primary ica_status updating">Updating</button>
            <button type="button" class="btn btn-primary ica_status planned">Planned for 2018</button>
          </div>
        </div>
        </br></br>
        <!-- the area with the short description on hover -->
        <div class="row">
          <div class="col-lg-12 text-center" id="short_description"> </div>
        </div>

      </div>
    </section>

    <!-- Request -->
    <section id="about">
      <div class="container">
        <div class="row">
          <div class="col-lg-12 text-center">
            <h2 class="section-heading">ICA Project</h2>
            <hr>
            <h3 class="section-subheading text-muted">Natural Shocks Risk, Drought Risk, Livelihood Zones, Land Degradation</h3>
          </div>
        </div>

        <div class="row text-center">
          <div class="col-md-12" style="padding-bottom: 20px;">
            <!-- <h4 class="service-heading">Project Description</h4> -->
            <p>ICA (Integrated Context Analysis) is one of the coolest projects ever. You want land degradation? We have it. You want livelihood analysis? We make it. You want Schock analysis? Shocking but we do that as well. 40 Countries since 2013 have implemented ICA. More than 10 indicators. </p>
          </div>
        </div>

        <div class="row">
            <div class="col-md-4">
              <div class="card text-white bg-primary o-hidden h-100">
                <div class="card-body">
                  <div class="card-body-icon">
                    <i class="fa fa-globe" style="margin-left:50%;font-size: 30px;height: 30px;vertical-align:middle;"></i>
                  </div>
                  <div class="mr-5" style="padding-top:25px; margin-left:26%;"><h3>42 Countries </h3></div>
                </div>
                <!--
                <a class="card-footer text-white clearfix small z-1" href="#">
                  <span class="float-left"> <h6> View Details </h6></span>
                  <span class="float-right">
                    <i class="fa fa-angle-right"></i>
                  </span>
                </a>
              -->
              </div>
            </div>

            <div class="col-md-4">
              <div class="card text-white bg-primary o-hidden h-100">
                <div class="card-body">
                  <div class="card-body-icon">
                    <i class="fa fa-tachometer " style="margin-left:50%;font-size: 30px;height: 30px;vertical-align:middle;"></i>
                  </div>
                  <div class="mr-5" style="padding-top:25px; margin-left:26%;"><h3> 10 Indicators </h3></div>
                </div>
              </div>
            </div>

            <div class="col-md-4">
              <div class="card text-white bg-primary o-hidden h-100">
                <div class="card-body">
                  <div class="card-body-icon">
                    <i class="fa fa-history" style="margin-left:50%;font-size: 30px;height: 30px;vertical-align:middle;"></i>
                  </div>
                  <div class="mr-5" style="padding-top:25px; margin-left:26%;"><h3>Since 2013 </h3></div>
                </div>
              </div>
            </div>


        </div>
      </div>
    </section>

    <!-- Contact -->
    <section id="contact">
      <div class="container">
        <div class="row">
          <div class="col-lg-12 text-center">
            <h2 class="section-heading">Contact Details</h2>
            <address style="color:white;">
              WFP Emergency Preparedness and Support Response Division<br>
              World Food Programme (HQ)<br>
              Via Cesare Giulio Viola, 68,<br>
              00148 Roma<br>
              Italy
            </address>
          </div>
        </div>
        <div class="row">
          <div class="col-lg-12">

          </div>
        </div>
      </div>
    </section>

    <!-- Footer -->
    <footer>
      <div class="container">
        <div class="row">
          <!--
          <div class="col-md-4">
            <span class="copyright">Copyright &copy; 2017</span>
          </div>
          <div class="col-md-4">
            <!--
            <ul class="list-inline social-buttons">
              <li class="list-inline-item">
                <a href="#">
                  <i class="fa fa-twitter"></i>
                </a>
              </li>
              <li class="list-inline-item">
                <a href="#">
                  <i class="fa fa-facebook"></i>
                </a>
              </li>
              <li class="list-inline-item">
                <a href="#">
                  <i class="fa fa-linkedin"></i>
                </a>
              </li>
            </ul>
          </div>-->
        </div>
      </div>
    </footer>


    <!-- Bootstrap core JavaScript -->
    <script src="vendor/jquery/jquery.min.js"></script>
    <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

    <!-- DataMaps -->
    <script src="//cdnjs.cloudflare.com/ajax/libs/d3/3.5.3/d3.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/topojson/1.6.9/topojson.min.js"></script>
    <script src="/json/datamaps.world.min.js"></script>
    <script type="text/javascript" src="get_data_by_year.js"></script>

    <script>

    function display_map(data, label_name, label_color){
      var map = new Datamap({
          element: document.getElementById('container'),
          geographyConfig: {
            highlightOnHover: true,
            popupOnHover: true,
            borderColor: '#444',
            borderWidth: 0.5,
            popupTemplate: function (geo, data) {
              $("#table").remove();
              //$("#short_description").append( "<p id='table'>" + data.name + "</p>" );
              $("#short_description").append( "<table id='table' class='table table-sm table-inverse' style='position:absolute;'><thead><tr><th>Country</th><th>Number of Indicators</th><th>Last Update</th></tr></thead><tbody><tr><td>" + data.adm0_name + "</td><td>" + data.indicators + "</td><td>" + data.last_update + "</td></tr></tbody></table>" );
              return ['<div class="hoverinfo"><strong>'+ geo.properties.name + '</strong></div>']
              // under this line no code
            }
          },
          done: function(datamap) {

            // zoom
            /*
            datamap.svg.call(d3.behavior.zoom().on("zoom", redraw));
            function redraw() {
              console.log(d3.event.scale)
              if (d3.event.scale >= 0.9){
                datamap.svg.selectAll("g").attr("transform", "translate(" + d3.event.translate + ")scale(" + d3.event.scale + ")");
              }
            }
            */

            datamap.svg.selectAll('.datamaps-subunit').on('click', function(geography) {

              var localData = map.options.data[geography.id]
              if (localData && localData.id) {
                country_iso3 = localData.id;
                sessionStorage['country_iso3'] = country_iso3;
                waitingDialog.show('Preparing Data');

                var currentTime = new Date();
                var current_year = currentTime.getFullYear();
                get_data_by_year(current_year, country_iso3);
                //var last_year = localData.last_update;
                //get_data_by_year(last_year, country_iso3);
                setTimeout(function(){
                  window.open("http://ica.local.com/country.html");
                  waitingDialog.hide();
                }, 2000);
              };
            });
          },
          dataUrl: data,
          dataType: 'csv',
          data: {},
          fills: {
            ICA_LEGEND: label_color,
            //ICA_OTHER: '#dcdfdc',
            defaultFill: '#dcdfdc' //'#abdda4'
          },

      });

      var l = {
        //legendTitle: "ICA Countries",
        //defaultFillName: "Whats left",
        labels: {
           ICA_LEGEND: label_name,
        },
      };
      map.legend(l);

    }

    // execute function
    data_url = 'json/ica_finalized.csv'
    //data_url = 'http://ica.local.com/json/world_test_1.csv'
    display_map(data_url, 'Finalized', '#00FF00');


    $(".ica_status").on( "click", function() {
      $(".datamap").remove();
      $(".datamaps-legend").remove();
      if ($(this).hasClass("ica_finalized")){
        display_map('json/ica_finalized.csv', 'Finalized', '#00FF00');
      }
      else if ($(this).hasClass("ica_ongoing")){
        display_map('json/ica_ongoing.csv', 'Ongoing', '#f6ec05');
      }
      else if ($(this).hasClass("updating")){
        display_map('json/ica_updating.csv', 'Updating', '#05f6f0');
      }
      else if ($(this).hasClass("planned")){
        display_map('json/ica_planned.csv', 'Planned', '#f6bc05');
      }
    });


    </script>


    <!-- Plugin JavaScript -->
    <script src="vendor/jquery-easing/jquery.easing.min.js"></script>
    <script src="js/waitingfor.js"></script>

    <!-- Custom scripts for this template -->
    <script src="js/hta.min.js"></script>


  </body>

</html>
